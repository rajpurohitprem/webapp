<!DOCTYPE html>
<html>
<head>
    <title>Channel Picker</title>
</head>
<body>
    <h2>Select a Channel</h2>
    <input type="text" id="user_id" placeholder="Your Telegram User ID"><br>
    <input type="text" id="session" placeholder="Your Telegram Session String"><br>
    <button onclick="fetchChannels()">Get Channels</button>
    <ul id="channelList"></ul>

    <script>
        async function fetchChannels() {
            const user_id = document.getElementById("user_id").value;
            const session = document.getElementById("session").value;
            const form = new FormData();
            form.append("user_id", user_id);
            form.append("session", session);
            
            const res = await fetch("/get_channels", {
                method: "POST",
                body: form
            });

            const data = await res.json();
            const list = document.getElementById("channelList");
            list.innerHTML = "";

            if (data.channels) {
                data.channels.forEach(ch => {
                    const li = document.createElement("li");
                    li.innerText = `${ch.title} (${ch.id})`;
                    list.appendChild(li);
                });
            } else {
                list.innerText = data.error || "Something went wrong.";
            }
        }
    </script>
</body>
</html>
